@use "sass:list";
@use "sass:string";
@use "./utils";

$name: neon;

$activated-styles: none;
$deactivated-styles: none;

@function as-per($number) {
  @return $number * 1%;
}

@function list-to-string($list) {
  @return #{string.slice(#{$list}, 2, -2)};
}

@function numbers-to-percentages($list) {
  $results: [];
  @each $value in $list {
    $results: list.append($results, as-per($value), $separator: comma);
  }
  @return list-to-string($results);
}

@function bracket-values($values) {
  $results: [];

  @each $value in $values {
    $results: list.append($results, as-per($value - 0.001), $separator: comma);
    $results: list.append($results, as-per($value + 0.1), $separator: comma);
  }
  @return list-to-string($results);
}

@mixin frames {
  $ons: [25, 35, 50, 60, 80, 99];
  @keyframes turn-on {
    #{bracket-values($ons)} {
      @include utils.render-styles($deactivated-styles);
    }

    #{numbers-to-percentages($ons)} {
      @include utils.render-styles($activated-styles);
    }
  }

  $offs: [1, 35, 36, 70, 71, 90, 99];
  @keyframes flicker {
    #{bracket-values($offs)} {
      @include utils.render-styles($activated-styles);
    }

    #{numbers-to-percentages($offs)} {
      @include utils.render-styles($deactivated-styles);
    }
  }
}

@mixin setup($duration: 20s) {
  .active {
    animation: turn-on 4s linear 0ms 1, flicker 15s linear 3s infinite alternate;
  }

  .inactive {
    @include utils.render-styles($deactivated-styles);
  }

  @include frames;
}
